configfile: "config/config.yaml"
envvars:
    "GITHUB_TOKEN"

# Load the configuration
sys.path.insert(0, config['main_wf_dir'] + "/config/")
import config_parser
config = config_parser.sub_wf_config_parser(
   main_cfg_fn = config['global_config_path'], 
   sub_wf_name = "sr_sc_sn")



include: "rules/cellranger.smk"
include: "rules/demuxlet.smk"

EMAIL = config["email"]


rule all:
    input:
         rules.cellranger.output,
         rules.demuxlet.output
   onsuccess:
      shell("mail -s 'DONE: ill_sc_sn Snakemake run' {EMAIL} < {log}")
   onerror:
      shell("mail -s 'ERROR: ill_sc_sn Snakemake run' {EMAIL} < {log}")